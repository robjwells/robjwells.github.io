<!doctype html><html lang=en>
<head>
<title>Primary Unit – Setting a date with TextExpander</title>
<meta charset=utf-8>
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self'; block-all-mixed-content; base-uri 'self'">
<link rel=license href=https://creativecommons.org/licenses/by/4.0/>
<link rel=alternate type=application/rss+xml href=/rss.xml title="Primary Unit">
<link rel=alternate type=application/json href=/feed.json title="Primary Unit">
<link rel=mask-icon href=/favicon.svg color=#1369bf>
<link rel=apple-touch-icon-precomposed href=/favicon.png>
<link rel=icon href=/favicon.ico>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="A blog by Rob Wells, mostly about computer stuff.">
<style>html,body,div,span,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,address,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strong,sub,sup,var,b,u,i,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,menu,nav,output,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}input,button{font-family:inherit}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}html{box-sizing:border-box;text-size-adjust:100%}*,*:before,*:after{box-sizing:inherit}:root{--grey:#607080;--grey10:#eff0f2;--grey5:#f7f8f9;--blue:#1369bf;--blue10:#e7eff8;--purple:#7436b3;--lineSpace:1.75rem;--halfLine:calc(var(--lineSpace) / 2);--quarterLine:calc(var(--lineSpace) / 4);--bigGap:calc(var(--lineSpace) * 2);--paragraphWidth:40rem;--wrapperWidth:50rem;--huge:1.75rem;--big:1.5625rem;--medium:1.375rem;--text:1.125rem;--small:0.875rem;--codeInText:0.875em;--bodyFonts:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Oxygen", Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Helvetica, sans-serif;--monospace:'Source Code Pro', 'Consolas', 'Menlo', 'Monaco', monospace}body{background-color:var(--grey5);font-family:var(--bodyFonts);font-size:var(--text);font-style:normal;font-weight:400;line-height:1.55555;text-size-adjust:100%;-webkit-text-size-adjust:100%}.wrapper{margin:0 auto;max-width:var(--wrapperWidth);padding:var(--lineSpace)var(--halfLine)}h2,h3,h4{margin:0 0 var(--lineSpace)}h2{font-size:var(--huge)}h3{font-size:var(--big)}h4{font-size:var(--medium)}blockquote,figure,p,pre,table,caption,dl,ol,ul,div.highlight{margin-bottom:var(--lineSpace)}blockquote,pre,div.highlight{background-color:var(--grey10);padding:var(--halfLine)}blockquote{font-style:italic}blockquote em,blockquote i{font-style:normal}blockquote p:last-child{margin-bottom:0}figcaption{font-style:italic}hr{border:none;border-top:1px solid var(--grey);margin:var(--lineSpace)0}img,video{box-sizing:content-box;border:1px solid var(--grey);height:auto;max-width:100%}pre{overflow-x:auto}dl,ol,ul{margin-bottom:var(--lineSpace)}ol,ul{list-style-position:outside;padding-left:var(--lineSpace)}ol{list-style-type:decimal}ul{list-style-type:square}a:link{color:var(--blue);text-decoration:underline}a:visited{color:var(--purple)}a:focus,a:hover,a:active{background-color:var(--blue10)}strong,b{font-weight:700}em,i{font-style:italic}code{font-size:var(--codeInText)}.highlight,pre code,small{font-size:var(--small)}.highlight,code{font-family:var(--monospace)}small{color:var(--grey)}table{width:100%}.table-container{overflow-x:auto}caption{font-style:italic}thead{border-bottom:1px solid var(--grey)}tfoot{border-top:1px solid var(--grey)}th,td{width:auto;padding:var(--halfLine);overflow:auto;text-align:left}th{background-color:var(--grey10);font-weight:700}.table-figures{text-align:right;font-family:var(--monospace)}.site-header{border-left:var(--quarterLine)solid var(--blue);display:flex;flex-wrap:wrap;margin-bottom:var(--lineSpace);padding-left:var(--quarterLine)}.site-title-container{flex-shrink:0;margin-right:var(--lineSpace);max-width:100%}.site-title{font-size:var(--huge);line-height:var(--huge);margin-bottom:0}.site-byline{margin-bottom:0}.site-links{color:var(--grey);list-style-type:none;margin-bottom:0;padding:0}.site-footer{margin-top:var(--bigGap)}article{border-bottom:1px solid var(--grey);margin-bottom:var(--bigGap)}article:last-of-type{border-bottom:none}article header{margin-bottom:var(--lineSpace)}article header h2{margin-bottom:0}article header time{color:var(--grey)}article li{margin-bottom:var(--halfLine)}.index-date{color:var(--grey);font-family:var(--monospace);font-size:var(--small);min-width:6rem;margin-right:var(--halfLine)}.index-item{margin-bottom:var(--halfLine)}.index-link{align-items:baseline;display:flex}.index-list{padding-left:0;list-style-type:none}.flag{background-color:var(--blue10);border-left:var(--quarterLine)solid var(--blue);margin-bottom:var(--lineSpace);padding:var(--halfLine)var(--quarterLine)}.flag :last-child{margin-bottom:0}.full-width{max-width:100%}.mute-links a{text-decoration:none;color:inherit}.no-border{border:0}.no-border img{border:0}.no-squish{overflow:auto}.no-squish img{max-width:none}@media screen and (min-width:40rem){.pull-left{float:left;clear:left;margin-right:var(--halfLine)}.pull-right{float:right;clear:right;margin-left:var(--halfLine)}.pull-left img,.pull-right img{display:block;margin-bottom:var(--lineSpace)}}</style>
<style>div.highlight>pre.chroma{padding:0;margin:0}:root{--lineNumberGrey:#6D6D6D;--operatorOrange:#B45000;--stringGreen:#357D06}.chroma .x{color:#000}.chroma .err{color:#a40000}.chroma .ln{margin-right:var(--halfLine);padding:0;color:var(--lineNumberGrey)}.chroma .k{color:#204a87;font-weight:700}.chroma .kc{color:#204a87;font-weight:700}.chroma .kd{color:#204a87;font-weight:700}.chroma .kn{color:#204a87;font-weight:700}.chroma .kp{color:#204a87;font-weight:700}.chroma .kr{color:#204a87;font-weight:700}.chroma .kt{color:#204a87;font-weight:700}.chroma .n{color:#000}.chroma .na{color:#c4a000}.chroma .nb{color:#204a87}.chroma .bp{color:#3465a4}.chroma .nc{color:#000}.chroma .no{color:#000}.chroma .nd{color:#5c35cc;font-weight:700}.chroma .ni{color:var(--operatorOrange)}.chroma .ne{color:#c00;font-weight:700}.chroma .nf{color:#000}.chroma .fm{color:#000}.chroma .nl{color:#f57900}.chroma .nn{color:#000}.chroma .nx{color:#000}.chroma .py{color:#000}.chroma .nt{color:#204a87;font-weight:700}.chroma .nv{color:#000}.chroma .vc{color:#000}.chroma .vg{color:#000}.chroma .vi{color:#000}.chroma .vm{color:#000}.chroma .l{color:#000}.chroma .ld{color:#000}.chroma .s{color:var(--stringGreen)}.chroma .sa{color:var(--stringGreen)}.chroma .sb{color:var(--stringGreen)}.chroma .sc{color:var(--stringGreen)}.chroma .dl{color:var(--stringGreen)}.chroma .sd{color:#8f5902;font-style:italic}.chroma .s2{color:var(--stringGreen)}.chroma .se{color:var(--stringGreen)}.chroma .sh{color:var(--stringGreen)}.chroma .si{color:var(--stringGreen)}.chroma .sx{color:var(--stringGreen)}.chroma .sr{color:var(--stringGreen)}.chroma .s1{color:var(--stringGreen)}.chroma .ss{color:var(--stringGreen)}.chroma .m{color:#0000cf;font-weight:700}.chroma .mb{color:#0000cf;font-weight:700}.chroma .mf{color:#0000cf;font-weight:700}.chroma .mh{color:#0000cf;font-weight:700}.chroma .mi{color:#0000cf;font-weight:700}.chroma .il{color:#0000cf;font-weight:700}.chroma .mo{color:#0000cf;font-weight:700}.chroma .o{color:var(--operatorOrange);font-weight:700}.chroma .ow{color:#204a87;font-weight:700}.chroma .p{color:#000;font-weight:700}.chroma .c{color:#8f5902;font-style:italic}.chroma .ch{color:#8f5902;font-style:italic}.chroma .cm{color:#8f5902;font-style:italic}.chroma .c1{color:#8f5902;font-style:italic}.chroma .cs{color:#8f5902;font-style:italic}.chroma .cp{color:#8f5902;font-style:italic}.chroma .cpf{color:#8f5902;font-style:italic}.chroma .g{color:#000}.chroma .gd{color:#a40000}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#ef2929}.chroma .gh{color:navy;font-weight:700}.chroma .gi{color:#00a000}.chroma .go{color:#000;font-style:italic}.chroma .gp{color:#8f5902}.chroma .gs{color:#000;font-weight:700}.chroma .gu{color:purple;font-weight:700}.chroma .gt{color:#a40000;font-weight:700}.chroma .gl{color:#000;text-decoration:underline}.chroma .w{color:#f8f8f8;text-decoration:underline}</style>
</head>
<body>
<div class=wrapper>
<header class=site-header>
<div class="site-title-container mute-links">
<h1 class=site-title><a href=/>Primary Unit</a></h1>
<p class=site-byline><i>by</i> Rob Wells</p>
</div>
<nav id=site-nav>
<ul class="site-links mute-links">
<li><a href=/about/>About</a></li>
<li><a href=/books/>Books I’ve read</a></li>
<li>
Feed:
<a href=/feed.json>JSON</a>,
<a href=/rss.xml>RSS</a>
</li>
</ul>
</nav>
</header>
<main>
<article>
<header>
<h2 class=mute-links><a href=/2013/03/setting-a-date-with-textexpander/>Setting a date with TextExpander</a></h2>
<p><time datetime=2013-03-06T10:45:00+0000>Wednesday, March 6 2013</time></p>
</header>
<p>I suck at dates. Badly.</p>
<p>Thankfully, there are a few ways to get around this in software — not least <a href=http://smilesoftware.com/TextExpander/index.html>TextExpander</a>, Smile’s ace text-substitution program. (I don’t use it nearly enough, but <a href=http://www.takecontrolbooks.com/textexpander>I’m looking to fix that</a>.)</p>
<p>TextExpander has a lot of date placeholders, so it’s obvious that I’m not the only one that needs help with this — but I may well be the first to be <em>this</em> bad. Here’s a list of the snippets in my Time & Date folder:</p>
<pre><code>;mdate   -&gt;   March 6 2013
;*ddate  -&gt;   Wednesday March 6 2013
;ds      -&gt;   _0306_0914
;time    -&gt;   09:14
;bd      -&gt;   20130306
;ldate   -&gt;   March 6, 2013
;sdate   -&gt;   06/03/2013
;dt      -&gt;   09:14, March 6, 2013
</code></pre>
<p>Those eight snippets include <em>seven</em> different ways to get the date, and <em>three</em> different ways to get the time. The worst part about this is that I can never remember which abbreviation corresponds to which date format.</p>
<p>Ok, let’s fix this. How many formats do I really need? I need a short date, a more human-friendly long date, the time, and the format used at <a href=http://www.morningstaronline.co.uk>work</a>.</p>
<p>So that’s four — only half as bad as before!</p>
<h3 id=time>Time</h3>
<p>I’m sticking with my old <code>;time</code> snippet here, a colon-separated 24-hour time. If I need a more human-friendly time, typing 10am or 8pm or whatever is as easy as typing an abbreviation (and TextExpander only does uppercase AM/PM, which I dislike). Here’s the snippet:</p>
<pre><code>%H:%M   -&gt;    10:23
</code></pre>
<h3 id=short-date>Short date</h3>
<p>Because, well, <a href=http://xkcd.com/1179/>XKCD</a>, I’m going to use the <a href=http://en.wikipedia.org/wiki/ISO_8601>ISO 8601 date format</a> for this. It means I can dump my separate backwards date snippet and avoids any confusion across DD/MM/YY and MM/DD/YY countries.</p>
<pre><code>%Y-%m-%d    -&gt;  2013-03-06
</code></pre>
<h3 id=long-date>Long date</h3>
<p>Since this is implicitly not the format to use when you’re counting characters and one that’s explicit enough to avoid confusion, there’s quite a bit of personal freedom here.</p>
<p>This one’s going to be more complicated than the previous two, as I want to use date suffixes (March 2nd, April 21st, etc). But TextExpander doesn&rsquo;t include a suffix placeholder, so let’s take advantage of its script support.</p>
<p>AppleScript’s built-in <code>current date</code> command returns an object from which we can extract all the pieces we need to construct a date, like so:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=k>set</span> <span class=nv>theDate</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>day</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
<span class=k>set</span> <span class=nv>theDay</span> <span class=k>to</span> <span class=nb>the</span> <span class=nv>weekday</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
<span class=k>set</span> <span class=nv>theMonth</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>month</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
<span class=k>set</span> <span class=nv>theYear</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>year</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
</code></pre></div><p>Now to build the suffix. Most dates have the suffix “th”, so we want to focus on the special cases: 1, 2, 3, 21, 22, and 31. We could check for each of these but there’s a smarter way.</p>
<p>We need to pull the date’s <strong>last</strong> character, which determines the suffix, so we can work with both single and double-digit dates:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=k>set</span> <span class=nv>lastChar</span> <span class=k>to</span> <span class=p>(</span><span class=nb>the</span> <span class=nb>last</span> <span class=nb>character</span> <span class=k>of</span> <span class=p>(</span><span class=nv>theDate</span> <span class=k>as </span><span class=nc>string</span><span class=p>))</span> <span class=k>as</span> <span class=nv>number</span>
</code></pre></div><p>Now we check for the most common situation (“th”) by testing <code>lastChar</code> against a range:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=k>if</span> <span class=nv>lastChar</span> <span class=ow>is</span> <span class=mi>0</span> <span class=ow>or</span> <span class=nv>lastChar</span> <span class=o>&gt;</span> <span class=mi>3</span> <span class=ow>or</span> <span class=p>(</span><span class=nv>theDate</span> <span class=o>&gt;</span> <span class=mi>10</span> <span class=ow>and</span><span class=se>¬
</span><span class=se></span> <span class=nv>theDate</span> <span class=o>&lt;</span> <span class=mi>21</span><span class=p>)</span> <span class=k>then</span>
    <span class=k>set</span> <span class=nv>theDate</span> <span class=k>to</span> <span class=p>(</span><span class=nv>theDate</span> <span class=k>as </span><span class=nc>string</span><span class=p>)</span> <span class=o>&amp;</span> <span class=s2>&#34;th&#34;</span>
</code></pre></div><p>If we put the other suffixes in order and in a list, we can use the last character of the date itself to extract the correct suffix:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=k>set</span> <span class=nv>theSuffixes</span> <span class=k>to</span> <span class=p>{</span><span class=s2>&#34;st&#34;</span><span class=p>,</span> <span class=s2>&#34;nd&#34;</span><span class=p>,</span> <span class=s2>&#34;rd&#34;</span><span class=p>}</span>
<span class=k>set</span> <span class=nv>theDate</span> <span class=k>to</span> <span class=p>(</span><span class=nv>theDate</span> <span class=k>as </span><span class=nc>string</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nb>item</span> <span class=nv>lastChar</span> <span class=k>of</span> <span class=nv>theSuffixes</span><span class=p>)</span>
</code></pre></div><p>Now let’s roll it up and <code>return</code> a constructed date:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=k>set</span> <span class=nv>theDate</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>day</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
<span class=k>set</span> <span class=nv>theDay</span> <span class=k>to</span> <span class=nb>the</span> <span class=nv>weekday</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
<span class=k>set</span> <span class=nv>theMonth</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>month</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>
<span class=k>set</span> <span class=nv>theYear</span> <span class=k>to</span> <span class=nb>the</span> <span class=nb>year</span> <span class=k>of</span> <span class=nb>the</span> <span class=p>(</span><span class=nb>current date</span><span class=p>)</span>

<span class=k>set</span> <span class=nv>lastChar</span> <span class=k>to</span> <span class=p>(</span><span class=nb>the</span> <span class=nb>last</span> <span class=nb>character</span> <span class=k>of</span> <span class=p>(</span><span class=nv>theDate</span> <span class=k>as </span><span class=nc>string</span><span class=p>))</span><span class=se>¬
</span><span class=se></span> <span class=k>as</span> <span class=nv>number</span>

<span class=k>if</span> <span class=nv>lastChar</span> <span class=o>&gt;</span> <span class=mi>3</span> <span class=ow>or</span> <span class=nv>lastChar</span> <span class=ow>is</span> <span class=mi>0</span> <span class=ow>or</span> <span class=p>(</span><span class=nv>theDate</span> <span class=o>&gt;</span> <span class=mi>10</span> <span class=ow>and</span><span class=se>¬
</span><span class=se></span> <span class=nv>theDate</span> <span class=o>&lt;</span> <span class=mi>21</span><span class=p>)</span> <span class=k>then</span>
    <span class=k>set</span> <span class=nv>theDate</span> <span class=k>to</span> <span class=p>(</span><span class=nv>theDate</span> <span class=k>as </span><span class=nc>string</span><span class=p>)</span> <span class=o>&amp;</span> <span class=s2>&#34;th&#34;</span>
<span class=k>else</span>
    <span class=k>set</span> <span class=nv>theSuffixes</span> <span class=k>to</span> <span class=p>{</span><span class=s2>&#34;st&#34;</span><span class=p>,</span> <span class=s2>&#34;nd&#34;</span><span class=p>,</span> <span class=s2>&#34;rd&#34;</span><span class=p>}</span>
    <span class=k>set</span> <span class=nv>theDate</span> <span class=k>to</span> <span class=p>(</span><span class=nv>theDate</span> <span class=k>as </span><span class=nc>string</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=nb>item</span> <span class=nv>lastChar</span><span class=se>¬
</span><span class=se></span>     <span class=k>of</span> <span class=nv>theSuffixes</span><span class=p>)</span>
<span class=k>end</span> <span class=k>if</span>

<span class=no>return</span> <span class=p>(</span><span class=nv>theDay</span> <span class=o>&amp;</span> <span class=s2>&#34;, &#34;</span> <span class=o>&amp;</span> <span class=nv>theMonth</span> <span class=o>&amp;</span> <span class=s2>&#34; &#34;</span> <span class=o>&amp;</span> <span class=nv>theDate</span> <span class=o>&amp;</span> <span class=s2>&#34;, &#34;</span> <span class=o>&amp;</span><span class=se>¬
</span><span class=se></span> <span class=nv>theYear</span><span class=p>)</span> <span class=k>as </span><span class=nc>string</span>
</code></pre></div><h3 id=end-result>End result</h3>
<p>Hey! You made it! I was sure I’d lose everyone in the middle of breaking down that AppleScript.</p>
<p>So, here’s what I’m left with:</p>
<pre><code>;iso    -&gt;    2013-03-06
;ldt    -&gt;    Wednesday, March 6th, 2013
;tm     -&gt;    10:21
</code></pre>
<p>Mix in one for work:</p>
<pre><code>;*dt    -&gt;    Wednesday March 6 2013
</code></pre>
<p>And we’re all set.</p>
</article>
</main>
<footer class=site-footer>
<small class=mute-links>
This work is licensed under a
<a rel=license href=https://creativecommons.org/licenses/by/4.0/>
Creative Commons Attribution 4.0 International License</a>.
</small>
</footer>
</div>
</body>
</html>