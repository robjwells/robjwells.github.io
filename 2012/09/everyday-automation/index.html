<!doctype html><html lang=en><head><title>Primary Unit – Everyday automation</title><meta charset=utf-8><meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self'; block-all-mixed-content; base-uri 'self'"><link rel=license href=https://creativecommons.org/licenses/by/4.0/><link rel=alternate type=application/rss+xml href=/rss.xml title="Primary Unit"><link rel=alternate type=application/json href=/feed.json title="Primary Unit"><link rel=mask-icon href=/favicon.svg color=#1369bf><link rel=apple-touch-icon-precomposed href=/favicon.png><link rel=icon href=/favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A blog by Rob Wells, mostly about computer stuff."><style>html,body,div,span,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,address,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strong,sub,sup,var,b,u,i,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,menu,nav,output,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}input,button{font-family:inherit}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}html{box-sizing:border-box;text-size-adjust:100%}*,*:before,*:after{box-sizing:inherit}:root{--grey:#607080;--grey10:#eff0f2;--grey5:#f7f8f9;--blue:#1369bf;--blue10:#e7eff8;--purple:#7436b3;--lineSpace:1.75rem;--halfLine:calc(var(--lineSpace) / 2);--quarterLine:calc(var(--lineSpace) / 4);--bigGap:calc(var(--lineSpace) * 2);--paragraphWidth:40rem;--wrapperWidth:50rem;--huge:1.75rem;--big:1.5625rem;--medium:1.375rem;--text:1.125rem;--small:0.875rem;--codeInText:0.875em;--bodyFonts:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Oxygen", Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Helvetica, sans-serif;--monospace:'Source Code Pro', 'Consolas', 'Menlo', 'Monaco', monospace}body{background-color:var(--grey5);font-family:var(--bodyFonts);font-size:var(--text);font-style:normal;font-weight:400;line-height:1.55555;text-size-adjust:100%;-webkit-text-size-adjust:100%}.wrapper{margin:0 auto;max-width:var(--wrapperWidth);padding:var(--lineSpace)var(--halfLine)}h2,h3,h4{margin:0 0 var(--lineSpace)}h2{font-size:var(--huge)}h3{font-size:var(--big)}h4{font-size:var(--medium)}blockquote,figure,p,pre,table,caption,dl,ol,ul,div.highlight{margin-bottom:var(--lineSpace)}blockquote,pre,div.highlight{background-color:var(--grey10);padding:var(--halfLine)}blockquote{font-style:italic}blockquote em,blockquote i{font-style:normal}blockquote p:last-child{margin-bottom:0}figcaption{font-style:italic}hr{border:none;border-top:1px solid var(--grey);margin:var(--lineSpace)0}img,video{box-sizing:content-box;border:1px solid var(--grey);height:auto;max-width:100%}pre{overflow-x:auto}dl,ol,ul{margin-bottom:var(--lineSpace)}ol,ul{list-style-position:outside;padding-left:var(--lineSpace)}ol{list-style-type:decimal}ul{list-style-type:square}a:link{color:var(--blue);text-decoration:underline}a:visited{color:var(--purple)}a:focus,a:hover,a:active{background-color:var(--blue10)}strong,b{font-weight:700}em,i{font-style:italic}code{font-size:var(--codeInText)}.highlight,pre code,small{font-size:var(--small)}.highlight,code{font-family:var(--monospace)}small{color:var(--grey)}table{width:100%}.table-container{overflow-x:auto}caption{font-style:italic}thead{border-bottom:1px solid var(--grey)}tfoot{border-top:1px solid var(--grey)}th,td{width:auto;padding:var(--halfLine);overflow:auto;text-align:left}th{background-color:var(--grey10);font-weight:700}.table-figures{text-align:right;font-family:var(--monospace)}.site-header{border-left:var(--quarterLine)solid var(--blue);display:flex;flex-wrap:wrap;margin-bottom:var(--lineSpace);padding-left:var(--quarterLine)}.site-title-container{flex-shrink:0;margin-right:var(--lineSpace);max-width:100%}.site-title{font-size:var(--huge);line-height:var(--huge);margin-bottom:0}.site-byline{margin-bottom:0}.site-links{color:var(--grey);list-style-type:none;margin-bottom:0;padding:0}.site-footer{margin-top:var(--bigGap)}article{border-bottom:1px solid var(--grey);margin-bottom:var(--bigGap)}article:last-of-type{border-bottom:none}article header{margin-bottom:var(--lineSpace)}article header h2{margin-bottom:0}article header time{color:var(--grey)}article li{margin-bottom:var(--halfLine)}.index-date{color:var(--grey);font-family:var(--monospace);font-size:var(--small);min-width:6rem;margin-right:var(--halfLine)}.index-item{margin-bottom:var(--halfLine)}.index-link{align-items:baseline;display:flex}.index-list{padding-left:0;list-style-type:none}.flag{background-color:var(--blue10);border-left:var(--quarterLine)solid var(--blue);margin-bottom:var(--lineSpace);padding:var(--halfLine)var(--quarterLine)}.flag :last-child{margin-bottom:0}.full-width{max-width:100%}.mute-links a{text-decoration:none;color:inherit}.no-border{border:0}.no-border img{border:0}.no-squish{overflow:auto}.no-squish img{max-width:none}@media screen and (min-width:40rem){.pull-left{float:left;clear:left;margin-right:var(--halfLine)}.pull-right{float:right;clear:right;margin-left:var(--halfLine)}.pull-left img,.pull-right img{display:block;margin-bottom:var(--lineSpace)}}</style><style>div.highlight>pre.chroma{padding:0;margin:0}:root{--lineNumberGrey:#6D6D6D;--operatorOrange:#B45000;--stringGreen:#357D06}.chroma .x{color:#000}.chroma .err{color:#a40000}.chroma .ln{margin-right:var(--halfLine);padding:0;color:var(--lineNumberGrey)}.chroma .k{color:#204a87;font-weight:700}.chroma .kc{color:#204a87;font-weight:700}.chroma .kd{color:#204a87;font-weight:700}.chroma .kn{color:#204a87;font-weight:700}.chroma .kp{color:#204a87;font-weight:700}.chroma .kr{color:#204a87;font-weight:700}.chroma .kt{color:#204a87;font-weight:700}.chroma .n{color:#000}.chroma .na{color:#c4a000}.chroma .nb{color:#204a87}.chroma .bp{color:#3465a4}.chroma .nc{color:#000}.chroma .no{color:#000}.chroma .nd{color:#5c35cc;font-weight:700}.chroma .ni{color:var(--operatorOrange)}.chroma .ne{color:#c00;font-weight:700}.chroma .nf{color:#000}.chroma .fm{color:#000}.chroma .nl{color:#f57900}.chroma .nn{color:#000}.chroma .nx{color:#000}.chroma .py{color:#000}.chroma .nt{color:#204a87;font-weight:700}.chroma .nv{color:#000}.chroma .vc{color:#000}.chroma .vg{color:#000}.chroma .vi{color:#000}.chroma .vm{color:#000}.chroma .l{color:#000}.chroma .ld{color:#000}.chroma .s{color:var(--stringGreen)}.chroma .sa{color:var(--stringGreen)}.chroma .sb{color:var(--stringGreen)}.chroma .sc{color:var(--stringGreen)}.chroma .dl{color:var(--stringGreen)}.chroma .sd{color:#8f5902;font-style:italic}.chroma .s2{color:var(--stringGreen)}.chroma .se{color:var(--stringGreen)}.chroma .sh{color:var(--stringGreen)}.chroma .si{color:var(--stringGreen)}.chroma .sx{color:var(--stringGreen)}.chroma .sr{color:var(--stringGreen)}.chroma .s1{color:var(--stringGreen)}.chroma .ss{color:var(--stringGreen)}.chroma .m{color:#0000cf;font-weight:700}.chroma .mb{color:#0000cf;font-weight:700}.chroma .mf{color:#0000cf;font-weight:700}.chroma .mh{color:#0000cf;font-weight:700}.chroma .mi{color:#0000cf;font-weight:700}.chroma .il{color:#0000cf;font-weight:700}.chroma .mo{color:#0000cf;font-weight:700}.chroma .o{color:var(--operatorOrange);font-weight:700}.chroma .ow{color:#204a87;font-weight:700}.chroma .p{color:#000;font-weight:700}.chroma .c{color:#8f5902;font-style:italic}.chroma .ch{color:#8f5902;font-style:italic}.chroma .cm{color:#8f5902;font-style:italic}.chroma .c1{color:#8f5902;font-style:italic}.chroma .cs{color:#8f5902;font-style:italic}.chroma .cp{color:#8f5902;font-style:italic}.chroma .cpf{color:#8f5902;font-style:italic}.chroma .g{color:#000}.chroma .gd{color:#a40000}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#ef2929}.chroma .gh{color:navy;font-weight:700}.chroma .gi{color:#00a000}.chroma .go{color:#000;font-style:italic}.chroma .gp{color:#8f5902}.chroma .gs{color:#000;font-weight:700}.chroma .gu{color:purple;font-weight:700}.chroma .gt{color:#a40000;font-weight:700}.chroma .gl{color:#000;text-decoration:underline}.chroma .w{color:#f8f8f8;text-decoration:underline}</style></head><body><div class=wrapper><header class=site-header><div class="site-title-container mute-links"><h1 class=site-title><a href=/>Primary Unit</a></h1><p class=site-byline><i>by</i> Rob Wells</p></div><nav id=site-nav><ul class="site-links mute-links"><li><a href=/about/>About</a></li><li><a href=/books/>Books I’ve read</a></li><li>Feed:
<a href=/feed.json>JSON</a>,
<a href=/rss.xml>RSS</a></li></ul></nav></header><main><article><header><h2 class=mute-links><a href=/2012/09/everyday-automation/>Everyday automation</a></h2><p><time datetime=2012-09-18T18:23:00+0000>Tuesday, September 18 2012</time></p></header><p>Learning AppleScript can really pay off.</p><p>It isn’t always the easiest language to work with, as anyone who’s ever used it will tell you. Commands that look like they should work sometimes don’t, you occasionally have to use bizarre methods to refer to <em>that thing right there</em>. It’s not a picnic.</p><p>But I’ve been using it for a little while and am pretty comfortable with it. I’ve ended up using it more and more for everyday tasks, or one-off situations that would usually require a lot of donkey work.</p><p>Let me share one that’s just happened.</p><p>I was browsing <a href=http://www.condenaststore.com/-se/newyorkerstore.htm>the New Yorker’s print shop</a> and — I thought — was opening up the individual pages for covers I liked and wanted to go back to after I’d finished browsing.</p><p>It turns out that I was just opening up the preview images in tabs. Whoops. And their URLs don’t contain a unique code that’s shared with their purchase pages. Ah. And there are 10 of them. Erm.</p><p>The one similarity they do have is that the filename is kinda sorta repeated on the purchase page, but it’s hyphen-separated so (<em>I thought, wrongly</em>) you can’t just copy and paste it into a search field.</p><p>So I cooked up this little script in about a minute:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-applescript data-lang=applescript><span class=line><span class=cl><span class=k>tell</span> <span class=nb>application</span> <span class=s2>&#34;Safari&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>set</span> <span class=nv>theURL</span> <span class=k>to</span> <span class=p>(</span><span class=k>get</span> <span class=nb>the</span> <span class=nv>URL</span> <span class=k>of</span> <span class=nb>the</span> <span class=nb>front</span> <span class=na>document</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>end</span> <span class=k>tell</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>printsOffset</span> <span class=k>to</span> <span class=p>(</span><span class=k>get</span> <span class=nb>the</span> <span class=nb>offset</span> <span class=k>of</span> <span class=s2>&#34;/prints/&#34;</span> <span class=k>in</span> <span class=nv>theURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>jpgOffset</span> <span class=k>to</span> <span class=p>(</span><span class=k>get</span> <span class=nb>the</span> <span class=nb>offset</span> <span class=k>of</span> <span class=s2>&#34;.jpg&#34;</span> <span class=k>in</span> <span class=nv>theURL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>hyphenString</span> <span class=k>to</span> <span class=nb>characters</span> <span class=p>(</span><span class=nv>printsOffset</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)</span> <span class=se>¬
</span></span></span><span class=line><span class=cl><span class=se></span><span class=nb>through</span> <span class=p>(</span><span class=nv>jpgOffset</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=k>of</span> <span class=nv>theURL</span> <span class=k>as </span><span class=nc>text</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=no>AppleScript</span>&#39;s <span class=no>text item delimiters</span> <span class=k>to</span> <span class=s2>&#34;-&#34;</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>theWords</span> <span class=k>to</span> <span class=p>(</span><span class=k>get</span> <span class=nb>the</span> <span class=nb>text</span> <span class=nb>items</span> <span class=k>of</span> <span class=nv>hyphenString</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=no>AppleScript</span>&#39;s <span class=no>text item delimiters</span> <span class=k>to</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=nv>searchString</span> <span class=k>to</span> <span class=nv>theWords</span> <span class=k>as </span><span class=nc>string</span>
</span></span><span class=line><span class=cl><span class=k>set</span> <span class=no>AppleScript</span>&#39;s <span class=no>text item delimiters</span> <span class=k>to</span> <span class=s2>&#34;&#34;</span> <span class=c>-- return to default</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>tell</span> <span class=nb>application</span> <span class=s2>&#34;Safari&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>tell</span> <span class=nb>the</span> <span class=nb>front</span> <span class=na>document</span>
</span></span><span class=line><span class=cl>        <span class=nv>search</span> <span class=nb>the</span> <span class=nv>web</span> <span class=nb>for</span> <span class=nv>searchString</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span> <span class=k>tell</span>
</span></span><span class=line><span class=cl><span class=k>end</span> <span class=k>tell</span>
</span></span></code></pre></div><p>Then I saved it, gave it a shortcut in <a href=http://www.red-sweater.com/fastscripts/>FastScripts</a>, opened up the first tab in Safari, hit the shortcut, tabbed to select the first URL in the search results, then hit enter to load it. Rinse, repeat.</p><p>As I was writing this I tried just pasting the filename into Google and — shocker — that works. Which makes me look a little dumb.</p><p>And the script isn’t even that sophisticated; I could have used a repeat command to loop through each tab, for example.</p><p>However my wider point about getting your teeth into automation still stands. I’ve written loads of little scripts like this over the past few months and, combined, they’ve saved me bags of time and plenty of frustration.</p><p>Hell, the InDesign script I wrote to set a text frame’s name (≥CS5) to its script label (≤CS4) alone saved me half an hour.</p><p>The problem of AppleScript being frustrating to learn — and continually frustrating with certain applications’ opaque AppleScript dictionaries and command parsing — does stand in the way of more people using it (which is why Automator exists, as limited as it is).</p><p>But if you’re tempted, even a little, give it a go. If you don’t have any programming experience I recommend <a href="http://www.amazon.co.uk/AppleScript-1-2-3-Self-Paced-Learning-Training/dp/0321149319/ref=sr_1_1?ie=UTF8&qid=1347986804&sr=8-1">AppleScript 1-2-3</a>. (Don’t buy the Kindle edition. You want the paper copy.)</p><p>Also make sure to check out <a href=http://www.latenightsw.com>Script Debugger 5</a>, which at $199 (about £170 including VAT) is a bit pricey if you’re just starting but makes things so much easier it’s a joke. It’s like switching from MSPaint to Photoshop. You’ll never go back to (Apple)Script Editor.</p><div class=flag><p><strong>Update 2012-09-12</p></strong><p>“Learning AppleScript can really pay off. Once you’ve suffered through its oddities enough to be able to write it without weeping, you’ll be tempted to write scripts that achieve things you can do with copy and paste, like this one.”</p><p>Maybe I should have thought harder about that first line.</p></div></article></main><footer class=site-footer><small class=mute-links>This work is licensed under a
<a rel=license href=https://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>.</small></footer></div></body></html>