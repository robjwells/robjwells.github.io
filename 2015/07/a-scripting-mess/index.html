<!doctype html><html lang=en>
<head>
<title>Primary Unit – A scripting mess</title>
<meta charset=utf-8>
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self'; block-all-mixed-content; base-uri 'self'">
<link rel=license href=https://creativecommons.org/licenses/by/4.0/>
<link rel=alternate type=application/rss+xml href=/rss.xml title="Primary Unit">
<link rel=alternate type=application/json href=/feed.json title="Primary Unit">
<link rel=mask-icon href=/favicon.svg color=#1369bf>
<link rel=apple-touch-icon-precomposed href=/favicon.png>
<link rel=icon href=/favicon.ico>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="A blog by Rob Wells, mostly about computer stuff.">
<style>html,body,div,span,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,address,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strong,sub,sup,var,b,u,i,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,menu,nav,output,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}input,button{font-family:inherit}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}html{box-sizing:border-box;text-size-adjust:100%}*,*:before,*:after{box-sizing:inherit}:root{--grey:#607080;--grey10:#eff0f2;--grey5:#f7f8f9;--blue:#1369bf;--blue10:#e7eff8;--purple:#7436b3;--lineSpace:1.75rem;--halfLine:calc(var(--lineSpace) / 2);--quarterLine:calc(var(--lineSpace) / 4);--bigGap:calc(var(--lineSpace) * 2);--paragraphWidth:40rem;--wrapperWidth:50rem;--huge:1.75rem;--big:1.5625rem;--medium:1.375rem;--text:1.125rem;--small:0.875rem;--codeInText:0.875em;--bodyFonts:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Oxygen", Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Helvetica, sans-serif;--monospace:'Source Code Pro', 'Consolas', 'Menlo', 'Monaco', monospace}body{background-color:var(--grey5);font-family:var(--bodyFonts);font-size:var(--text);font-style:normal;font-weight:400;line-height:1.55555;text-size-adjust:100%;-webkit-text-size-adjust:100%}.wrapper{margin:0 auto;max-width:var(--wrapperWidth);padding:var(--lineSpace)var(--halfLine)}h2,h3,h4{margin:0 0 var(--lineSpace)}h2{font-size:var(--huge)}h3{font-size:var(--big)}h4{font-size:var(--medium)}blockquote,figure,p,pre,table,caption,dl,ol,ul,div.highlight{margin-bottom:var(--lineSpace)}blockquote,pre,div.highlight{background-color:var(--grey10);padding:var(--halfLine)}blockquote{font-style:italic}blockquote em,blockquote i{font-style:normal}blockquote p:last-child{margin-bottom:0}figcaption{font-style:italic}hr{border:none;border-top:1px solid var(--grey);margin:var(--lineSpace)0}img,video{box-sizing:content-box;border:1px solid var(--grey);height:auto;max-width:100%}pre{overflow-x:auto}dl,ol,ul{margin-bottom:var(--lineSpace)}ol,ul{list-style-position:outside;padding-left:var(--lineSpace)}ol{list-style-type:decimal}ul{list-style-type:square}a:link{color:var(--blue);text-decoration:underline}a:visited{color:var(--purple)}a:focus,a:hover,a:active{background-color:var(--blue10)}strong,b{font-weight:700}em,i{font-style:italic}code{font-size:var(--codeInText)}.highlight,pre code,small{font-size:var(--small)}.highlight,code{font-family:var(--monospace)}small{color:var(--grey)}table{width:100%}.table-container{overflow-x:auto}caption{font-style:italic}thead{border-bottom:1px solid var(--grey)}tfoot{border-top:1px solid var(--grey)}th,td{width:auto;padding:var(--halfLine);overflow:auto;text-align:left}th{background-color:var(--grey10);font-weight:700}.table-figures{text-align:right;font-family:var(--monospace)}.site-header{border-left:var(--quarterLine)solid var(--blue);display:flex;flex-wrap:wrap;margin-bottom:var(--lineSpace);padding-left:var(--quarterLine)}.site-title-container{flex-shrink:0;margin-right:var(--lineSpace);max-width:100%}.site-title{font-size:var(--huge);line-height:var(--huge);margin-bottom:0}.site-byline{margin-bottom:0}.site-links{color:var(--grey);list-style-type:none;margin-bottom:0;padding:0}.site-footer{margin-top:var(--bigGap)}article{border-bottom:1px solid var(--grey);margin-bottom:var(--bigGap)}article:last-of-type{border-bottom:none}article header{margin-bottom:var(--lineSpace)}article header h2{margin-bottom:0}article header time{color:var(--grey)}article li{margin-bottom:var(--halfLine)}.index-date{color:var(--grey);font-family:var(--monospace);font-size:var(--small);min-width:6rem;margin-right:var(--halfLine)}.index-item{margin-bottom:var(--halfLine)}.index-link{align-items:baseline;display:flex}.index-list{padding-left:0;list-style-type:none}.flag{background-color:var(--blue10);border-left:var(--quarterLine)solid var(--blue);margin-bottom:var(--lineSpace);padding:var(--halfLine)var(--quarterLine)}.flag :last-child{margin-bottom:0}.full-width{max-width:100%}.mute-links a{text-decoration:none;color:inherit}.no-border{border:0}.no-border img{border:0}.no-squish{overflow:auto}.no-squish img{max-width:none}@media screen and (min-width:40rem){.pull-left{float:left;clear:left;margin-right:var(--halfLine)}.pull-right{float:right;clear:right;margin-left:var(--halfLine)}.pull-left img,.pull-right img{display:block;margin-bottom:var(--lineSpace)}}</style>
</head>
<body>
<div class=wrapper>
<header class=site-header>
<div class="site-title-container mute-links">
<h1 class=site-title><a href=/>Primary Unit</a></h1>
<p class=site-byline><i>by</i> Rob Wells</p>
</div>
<nav id=site-nav>
<ul class="site-links mute-links">
<li><a href=/about/>About</a></li>
<li><a href=/books/>Books I’ve read</a></li>
<li>
Feed:
<a href=/feed.json>JSON</a>,
<a href=/rss.xml>RSS</a>
</li>
</ul>
</nav>
</header>
<main>
<article>
<header>
<h2 class=mute-links><a href=/2015/07/a-scripting-mess/>A scripting mess</a></h2>
<p><time datetime=2015-07-05T16:52:00+0000>Sunday, July 5 2015</time></p>
</header>
<p>I was thinking about redoing the <a href=https://github.com/robjwells/feral-four/blob/Illadelph/core.applescript>page generator script</a> for work again this morning, wondering if the newly widespread support for JavaScript in Cocoa applications and JavaScript for Automation would simplify some of the work I started on a Cocoa page-generating application.</p>
<p>The short answer is No. In fact I’m more disheartened at the state of inter-application scripting now than I was a year ago.</p>
<p>I began working on the application in January 2014, but hadn’t touched the project since last June. I got a bit bogged down with it, and it was by far too big a project to start with; I’d just finished the Big Nerd Ranch <a href=https://www.bignerdranch.com/we-write/objective-c-programming/>Objective-C</a> and <a href=https://www.bignerdranch.com/we-write/cocoa-programming/>Cocoa</a> books and while they were very good, and I learnt loads, I should’ve made some toy applications by myself before tackling it.</p>
<p>In short, it would have been a GUI application that created both preset and custom batches of InDesign documents and changed certain elements on those pages (dates, page numbers), with the user having the ability to change those presets.</p>
<p>One of the biggest hurdles was working with AppleScript from Cocoa. I had to <a href=https://gist.github.com/robjwells/9d1480e4b7a1a8312eca>define a category on NSAppleScript</a> to make bearable calling AppleScript handlers (from a compiled <code>.scpt</code> file used as a library). And this was my first attempt at a Cocoa programme without the help of the BNR books! It was a mess (that category is a mess, but it does work) and I got discouraged.</p>
<p>But when I come back to it, that will be the way I’ll do it, because the other options are so poor.</p>
<p>A “native” Cocoa option is Scripting Bridge. It <a href=https://developer.apple.com/library/mac/releasenotes/ScriptingAutomation/RN-ScriptingBridge/>hasn’t been updated since 10.6</a>, but so what? If it works, it works. It doesn’t work. The generated header for InDesign is 10MB and Xcode hangs when you try to open it. The thousands of enums, typedefs, interfaces, methods and properties even bring BBEdit to its knees when you try to use the function menu or “Named Symbol…” browser.</p>
<p>Well, OK, let’s settle for not being able to properly browse the header, and just include it and poke around. Nope! Xcode won’t compile with it included (because of about 20 errors, mostly “duplicate” definitions that come from flattening InDesign’s enormous scripting dictionary).</p>
<p>Now let’s look at the two JavaScript options: InDesign’s built-in JavaScript interpreter and JavaScript for Automation, introduced at last year’s WWDC. Both Adobe’s ExtendScript Toolkit and Script Editor don’t provide the kind of support you need to navigate the complex object model. We also have the problem of trying to pass arguments to the built-in JavaScript interpreter from Cocoa.</p>
<p>JavaScript for Automation meanwhile has poor documentation. It’s not clear to me how to achieve the same results I do in AppleScript with JavaScript. (What’s <code>.get()</code> all about?) There’s no interface to call such scripts from Cocoa. And the <a href=https://developer.apple.com/library/prerelease/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/Articles/OSX10-11.html>preliminary change notes for OS X 10.11</a> don’t contain any significant changes.</p>
<p>What a mess. Automation is crucial for our work, and solves so many of our problems. But the existing technologies have so many sharp edges and the “new” one, JavaScript for Automation, is not anything close to the fresh start that might reinvigorate things.</p>
<p>This year’s WWDC talk on automation was <a href="https://developer.apple.com/videos/wwdc/2015/?id=306">Supporting the Enterprise with OS X Automation</a>. At the start, Sal Soghoian — Mr Automation at Apple — says:</p>
<blockquote>
<p>Some days I feel like I’m a dinosaur looking for a tar pit</p>
</blockquote>
<p>It’s not looking good.</p>
</article>
</main>
<footer class=site-footer>
<small class=mute-links>
This work is licensed under a
<a rel=license href=https://creativecommons.org/licenses/by/4.0/>
Creative Commons Attribution 4.0 International License</a>.
</small>
</footer>
</div>
</body>
</html>