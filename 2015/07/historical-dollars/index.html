<!doctype html><html lang=en>
<head>
<title>Primary Unit – Historical dollars</title>
<meta charset=utf-8>
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; media-src 'self'; block-all-mixed-content; base-uri 'self'">
<link rel=license href=https://creativecommons.org/licenses/by/4.0/>
<link rel=alternate type=application/rss+xml href=/rss.xml title="Primary Unit">
<link rel=alternate type=application/json href=/feed.json title="Primary Unit">
<link rel=mask-icon href=/favicon.svg color=#1369bf>
<link rel=apple-touch-icon-precomposed href=/favicon.png>
<link rel=icon href=/favicon.ico>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="A blog by Rob Wells, mostly about computer stuff.">
<style>html,body,div,span,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,address,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strong,sub,sup,var,b,u,i,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,menu,nav,output,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}input,button{font-family:inherit}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}html{box-sizing:border-box;text-size-adjust:100%}*,*:before,*:after{box-sizing:inherit}:root{--grey:#607080;--grey10:#eff0f2;--grey5:#f7f8f9;--blue:#1369bf;--blue10:#e7eff8;--purple:#7436b3;--lineSpace:1.75rem;--halfLine:calc(var(--lineSpace) / 2);--quarterLine:calc(var(--lineSpace) / 4);--bigGap:calc(var(--lineSpace) * 2);--paragraphWidth:40rem;--wrapperWidth:50rem;--huge:1.75rem;--big:1.5625rem;--medium:1.375rem;--text:1.125rem;--small:0.875rem;--codeInText:0.875em;--bodyFonts:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Oxygen", Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Helvetica, sans-serif;--monospace:'Source Code Pro', 'Consolas', 'Menlo', 'Monaco', monospace}body{background-color:var(--grey5);font-family:var(--bodyFonts);font-size:var(--text);font-style:normal;font-weight:400;line-height:1.55555;text-size-adjust:100%;-webkit-text-size-adjust:100%}.wrapper{margin:0 auto;max-width:var(--wrapperWidth);padding:var(--lineSpace)var(--halfLine)}h2,h3,h4{margin:0 0 var(--lineSpace)}h2{font-size:var(--huge)}h3{font-size:var(--big)}h4{font-size:var(--medium)}blockquote,figure,p,pre,table,caption,dl,ol,ul,div.highlight{margin-bottom:var(--lineSpace)}blockquote,pre,div.highlight{background-color:var(--grey10);padding:var(--halfLine)}blockquote{font-style:italic}blockquote em,blockquote i{font-style:normal}blockquote p:last-child{margin-bottom:0}figcaption{font-style:italic}hr{border:none;border-top:1px solid var(--grey);margin:var(--lineSpace)0}img,video{box-sizing:content-box;border:1px solid var(--grey);height:auto;max-width:100%}pre{overflow-x:auto}dl,ol,ul{margin-bottom:var(--lineSpace)}ol,ul{list-style-position:outside;padding-left:var(--lineSpace)}ol{list-style-type:decimal}ul{list-style-type:square}a:link{color:var(--blue);text-decoration:underline}a:visited{color:var(--purple)}a:focus,a:hover,a:active{background-color:var(--blue10)}strong,b{font-weight:700}em,i{font-style:italic}code{font-size:var(--codeInText)}.highlight,pre code,small{font-size:var(--small)}.highlight,code{font-family:var(--monospace)}small{color:var(--grey)}table{width:100%}.table-container{overflow-x:auto}caption{font-style:italic}thead{border-bottom:1px solid var(--grey)}tfoot{border-top:1px solid var(--grey)}th,td{width:auto;padding:var(--halfLine);overflow:auto;text-align:left}th{background-color:var(--grey10);font-weight:700}.table-figures{text-align:right;font-family:var(--monospace)}.site-header{border-left:var(--quarterLine)solid var(--blue);display:flex;flex-wrap:wrap;margin-bottom:var(--lineSpace);padding-left:var(--quarterLine)}.site-title-container{flex-shrink:0;margin-right:var(--lineSpace);max-width:100%}.site-title{font-size:var(--huge);line-height:var(--huge);margin-bottom:0}.site-byline{margin-bottom:0}.site-links{color:var(--grey);list-style-type:none;margin-bottom:0;padding:0}.site-footer{margin-top:var(--bigGap)}article{border-bottom:1px solid var(--grey);margin-bottom:var(--bigGap)}article:last-of-type{border-bottom:none}article header{margin-bottom:var(--lineSpace)}article header h2{margin-bottom:0}article header time{color:var(--grey)}article li{margin-bottom:var(--halfLine)}.index-date{color:var(--grey);font-family:var(--monospace);font-size:var(--small);min-width:6rem;margin-right:var(--halfLine)}.index-item{margin-bottom:var(--halfLine)}.index-link{align-items:baseline;display:flex}.index-list{padding-left:0;list-style-type:none}.flag{background-color:var(--blue10);border-left:var(--quarterLine)solid var(--blue);margin-bottom:var(--lineSpace);padding:var(--halfLine)var(--quarterLine)}.flag :last-child{margin-bottom:0}.full-width{max-width:100%}.mute-links a{text-decoration:none;color:inherit}.no-border{border:0}.no-border img{border:0}.no-squish{overflow:auto}.no-squish img{max-width:none}@media screen and (min-width:40rem){.pull-left{float:left;clear:left;margin-right:var(--halfLine)}.pull-right{float:right;clear:right;margin-left:var(--halfLine)}.pull-left img,.pull-right img{display:block;margin-bottom:var(--lineSpace)}}</style>
<style>div.highlight>pre.chroma{padding:0;margin:0}:root{--lineNumberGrey:#6D6D6D;--operatorOrange:#B45000;--stringGreen:#357D06}.chroma .x{color:#000}.chroma .err{color:#a40000}.chroma .ln{margin-right:var(--halfLine);padding:0;color:var(--lineNumberGrey)}.chroma .k{color:#204a87;font-weight:700}.chroma .kc{color:#204a87;font-weight:700}.chroma .kd{color:#204a87;font-weight:700}.chroma .kn{color:#204a87;font-weight:700}.chroma .kp{color:#204a87;font-weight:700}.chroma .kr{color:#204a87;font-weight:700}.chroma .kt{color:#204a87;font-weight:700}.chroma .n{color:#000}.chroma .na{color:#c4a000}.chroma .nb{color:#204a87}.chroma .bp{color:#3465a4}.chroma .nc{color:#000}.chroma .no{color:#000}.chroma .nd{color:#5c35cc;font-weight:700}.chroma .ni{color:var(--operatorOrange)}.chroma .ne{color:#c00;font-weight:700}.chroma .nf{color:#000}.chroma .fm{color:#000}.chroma .nl{color:#f57900}.chroma .nn{color:#000}.chroma .nx{color:#000}.chroma .py{color:#000}.chroma .nt{color:#204a87;font-weight:700}.chroma .nv{color:#000}.chroma .vc{color:#000}.chroma .vg{color:#000}.chroma .vi{color:#000}.chroma .vm{color:#000}.chroma .l{color:#000}.chroma .ld{color:#000}.chroma .s{color:var(--stringGreen)}.chroma .sa{color:var(--stringGreen)}.chroma .sb{color:var(--stringGreen)}.chroma .sc{color:var(--stringGreen)}.chroma .dl{color:var(--stringGreen)}.chroma .sd{color:#8f5902;font-style:italic}.chroma .s2{color:var(--stringGreen)}.chroma .se{color:var(--stringGreen)}.chroma .sh{color:var(--stringGreen)}.chroma .si{color:var(--stringGreen)}.chroma .sx{color:var(--stringGreen)}.chroma .sr{color:var(--stringGreen)}.chroma .s1{color:var(--stringGreen)}.chroma .ss{color:var(--stringGreen)}.chroma .m{color:#0000cf;font-weight:700}.chroma .mb{color:#0000cf;font-weight:700}.chroma .mf{color:#0000cf;font-weight:700}.chroma .mh{color:#0000cf;font-weight:700}.chroma .mi{color:#0000cf;font-weight:700}.chroma .il{color:#0000cf;font-weight:700}.chroma .mo{color:#0000cf;font-weight:700}.chroma .o{color:var(--operatorOrange);font-weight:700}.chroma .ow{color:#204a87;font-weight:700}.chroma .p{color:#000;font-weight:700}.chroma .c{color:#8f5902;font-style:italic}.chroma .ch{color:#8f5902;font-style:italic}.chroma .cm{color:#8f5902;font-style:italic}.chroma .c1{color:#8f5902;font-style:italic}.chroma .cs{color:#8f5902;font-style:italic}.chroma .cp{color:#8f5902;font-style:italic}.chroma .cpf{color:#8f5902;font-style:italic}.chroma .g{color:#000}.chroma .gd{color:#a40000}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#ef2929}.chroma .gh{color:navy;font-weight:700}.chroma .gi{color:#00a000}.chroma .go{color:#000;font-style:italic}.chroma .gp{color:#8f5902}.chroma .gs{color:#000;font-weight:700}.chroma .gu{color:purple;font-weight:700}.chroma .gt{color:#a40000;font-weight:700}.chroma .gl{color:#000;text-decoration:underline}.chroma .w{color:#f8f8f8;text-decoration:underline}</style>
</head>
<body>
<div class=wrapper>
<header class=site-header>
<div class="site-title-container mute-links">
<h1 class=site-title><a href=/>Primary Unit</a></h1>
<p class=site-byline><i>by</i> Rob Wells</p>
</div>
<nav id=site-nav>
<ul class="site-links mute-links">
<li><a href=/about/>About</a></li>
<li><a href=/books/>Books I’ve read</a></li>
<li>
Feed:
<a href=/feed.json>JSON</a>,
<a href=/rss.xml>RSS</a>
</li>
</ul>
</nav>
</header>
<main>
<article>
<header>
<h2 class=mute-links><a href=/2015/07/historical-dollars/>Historical dollars</a></h2>
<p><time datetime=2015-07-15T23:40:00+0000>Wednesday, July 15 2015</time></p>
</header>
<p>I’ve read <a href=https://en.wikipedia.org/wiki/A_People%27s_History_of_the_United_States>a</a> <a href=https://en.wikipedia.org/wiki/The_Big_Sleep>few</a> <a href=http://www.haymarketbooks.org/hc/People-Wasnt-Made-to-Burn>books</a> recently where references were made to dollar amounts from many years ago. However, I often find it difficult to understand the context of, say, $10,000 in 1829.</p>
<p>But Wolfram Alpha <a href="http://www.wolframalpha.com/input/?i=$10,000+(1829+US+dollars)+in+2015">can give you a rough approximation</a> by applying inflation data. This isn’t perfect but is useful to get a general idea of what a similar amount might be today. (There isn’t all the context needed for a more accurate determination, and the underlying basket for inflation measures can be misleading.)</p>
<p>Handily, there’s a <a href=http://products.wolframalpha.com/api/>Wolfram Alpha API</a> we can use to get this information programmatically. I originally wrote this script as a command-line tool, but how often do you read at your computer with a terminal window open? So the one in this post uses <a href=http://omz-software.com/pythonista/index.html>Pythonista</a> and its <code>ui</code> module to make things more practical.</p>
<p>The code to get the new amount is pretty trivial:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=ln> 1</span><span class=kn>from</span> <span class=nn>__future__</span> <span class=kn>import</span> <span class=n>division</span>
<span class=ln> 2</span>
<span class=ln> 3</span><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>date</span>
<span class=ln> 4</span><span class=kn>from</span> <span class=nn>xml.etree</span> <span class=kn>import</span> <span class=n>ElementTree</span>
<span class=ln> 5</span><span class=kn>import</span> <span class=nn>requests</span>
<span class=ln> 6</span><span class=kn>import</span> <span class=nn>ui</span>
<span class=ln> 7</span>
<span class=ln> 8</span>
<span class=ln> 9</span><span class=k>def</span> <span class=nf>calculate_amount</span><span class=p>(</span><span class=n>sender</span><span class=p>):</span>
<span class=ln>10</span>  <span class=s2>&#34;&#34;&#34;Convert given dollar amount for given year to current dollars&#34;&#34;&#34;</span>
<span class=ln>11</span>  <span class=n>amount</span> <span class=o>=</span> <span class=n>view</span><span class=p>[</span><span class=s1>&#39;amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>text</span>
<span class=ln>12</span>  <span class=n>year</span> <span class=o>=</span> <span class=n>view</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>text</span>
<span class=ln>13</span>
<span class=ln>14</span>  <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>amount</span> <span class=ow>and</span> <span class=n>year</span><span class=p>):</span>
<span class=ln>15</span>    <span class=k>return</span>
<span class=ln>16</span>
<span class=ln>17</span>  <span class=n>api_key</span> <span class=o>=</span> <span class=s1>&#39;YOUR API KEY IN HERE&#39;</span>
<span class=ln>18</span>  <span class=n>api_url</span> <span class=o>=</span> <span class=s1>&#39;http://api.wolframalpha.com/v2/query&#39;</span>
<span class=ln>19</span>  <span class=n>query_template</span> <span class=o>=</span> <span class=s1>&#39;$</span><span class=si>{amount}</span><span class=s1> (</span><span class=si>{past_year}</span><span class=s1> US dollars) in </span><span class=si>{current_year}</span><span class=s1>&#39;</span>
<span class=ln>20</span>  <span class=n>query</span> <span class=o>=</span> <span class=n>query_template</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>amount</span><span class=o>=</span><span class=n>amount</span><span class=p>,</span>
<span class=ln>21</span>                                <span class=n>past_year</span><span class=o>=</span><span class=n>year</span><span class=p>,</span>
<span class=ln>22</span>                                <span class=n>current_year</span><span class=o>=</span><span class=n>date</span><span class=o>.</span><span class=n>today</span><span class=p>()</span><span class=o>.</span><span class=n>year</span><span class=p>)</span>
<span class=ln>23</span>  <span class=n>parameters</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;appid&#39;</span><span class=p>:</span> <span class=n>api_key</span><span class=p>,</span>
<span class=ln>24</span>                <span class=s1>&#39;input&#39;</span><span class=p>:</span> <span class=n>query</span><span class=p>,</span>
<span class=ln>25</span>                <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=s1>&#39;plaintext&#39;</span><span class=p>,</span>
<span class=ln>26</span>                <span class=s1>&#39;podtitle&#39;</span><span class=p>:</span> <span class=s1>&#39;Result&#39;</span><span class=p>}</span>
<span class=ln>27</span>  <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>api_url</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=n>parameters</span><span class=p>)</span>
<span class=ln>28</span>  <span class=n>xml_soup</span> <span class=o>=</span> <span class=n>ElementTree</span><span class=o>.</span><span class=n>fromstring</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
<span class=ln>29</span>  <span class=n>new_amount</span> <span class=o>=</span> <span class=n>xml_soup</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;pod/subpod/plaintext&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span>
<span class=ln>30</span>  <span class=n>view</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=n>new_amount</span>
</code></pre></div><p>The <code>calculate_amount</code> function above is called on a button press (hence the <code>sender</code> argument) and fetches the text from a couple of UI elements (all that <code>view</code> subscripting), bailing out if either the amount or year is missing.</p>
<p>The query template (line 19) is how Wolfram Alpha parses historical dollar calculations (shown as “Input interpretation” on the website) so we can skip as much parsing time as possible.</p>
<p>Requests makes sending the query a doddle, and we use an exact XPath expression to get at the result in the response. There’s an <a href=http://products.wolframalpha.com/api/explorer.html>API explorer</a> so you can get a handle on the structure. (Normally I’d use Beautiful Soup, but Pythonista doesn’t include lxml, so BS parses it as HTML and there’s really no point in risking — however slightly — that causing some problem. ElementTree isn’t bad if you’re doing something simple, anyway.)</p>
<p>Lastly we update another UI element to show the result. Pretty simple.</p>
<p>With the UI, you’ve got two choices: make it in code or use Pythonista’s UI editor. I chose to do it in code, because the UI editor saves a <code>.pyui</code> JSON file that <a href=https://omz-forums.appspot.com/pythonista/post/5254558653612032>takes a little work to share</a>.</p>
<p>But now I would recommend people use the editor, as actually getting the code to work was a bit of a headache too. For the record: Ole Zorn has done an <em>incredible</em> job with Pythonista and the UI tools are incredible. However: the <code>ui</code> module seems to expose the Cocoa way of making GUIs, so unless you’ve got an understanding of that you may be in for some bumps. Helpfully, you can <a href=http://omz-software.com/pythonista/docs/ios/ui.html>view the <code>ui</code> module documentation online</a> Here’s the rest of the code:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=ln>33</span><span class=k>def</span> <span class=nf>setup_view</span><span class=p>():</span>
<span class=ln>34</span>    <span class=n>view</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>View</span><span class=p>()</span>
<span class=ln>35</span>    <span class=n>view</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Historical Dollars&#39;</span>
<span class=ln>36</span>    <span class=n>view</span><span class=o>.</span><span class=n>background_color</span> <span class=o>=</span> <span class=s1>&#39;white&#39;</span>
<span class=ln>37</span>    <span class=n>view</span><span class=o>.</span><span class=n>width</span><span class=p>,</span> <span class=n>view</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>get_screen_size</span><span class=p>()</span>
<span class=ln>38</span>
<span class=ln>39</span>    <span class=n>amount_field</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>TextField</span><span class=p>()</span>
<span class=ln>40</span>    <span class=n>amount_field</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;amount&#39;</span>
<span class=ln>41</span>    <span class=n>amount_field</span><span class=o>.</span><span class=n>keyboard_type</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>KEYBOARD_DECIMAL_PAD</span>
<span class=ln>42</span>    <span class=n>amount_field</span><span class=o>.</span><span class=n>placeholder</span> <span class=o>=</span> <span class=s1>&#39;Dollar amount&#39;</span>
<span class=ln>43</span>    <span class=n>amount_field</span><span class=o>.</span><span class=n>width</span> <span class=o>*=</span> <span class=mi>2</span>
<span class=ln>44</span>    <span class=n>amount_field</span><span class=o>.</span><span class=n>height</span> <span class=o>/=</span> <span class=mi>2</span>
<span class=ln>45</span>
<span class=ln>46</span>    <span class=n>year_field</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>TextField</span><span class=p>()</span>
<span class=ln>47</span>    <span class=n>year_field</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;year&#39;</span>
<span class=ln>48</span>    <span class=n>year_field</span><span class=o>.</span><span class=n>keyboard_type</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>KEYBOARD_NUMBER_PAD</span>
<span class=ln>49</span>    <span class=n>year_field</span><span class=o>.</span><span class=n>placeholder</span> <span class=o>=</span> <span class=s1>&#39;Year&#39;</span>
<span class=ln>50</span>    <span class=n>year_field</span><span class=o>.</span><span class=n>width</span> <span class=o>*=</span> <span class=mi>2</span>
<span class=ln>51</span>    <span class=n>year_field</span><span class=o>.</span><span class=n>height</span> <span class=o>/=</span> <span class=mi>2</span>
<span class=ln>52</span>
<span class=ln>53</span>    <span class=n>button</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>Button</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s1>&#39;Calculate&#39;</span><span class=p>)</span>
<span class=ln>54</span>    <span class=n>button</span><span class=o>.</span><span class=n>action</span> <span class=o>=</span> <span class=n>calculate_amount</span>
<span class=ln>55</span>
<span class=ln>56</span>    <span class=n>result_label</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>Label</span><span class=p>()</span>
<span class=ln>57</span>    <span class=n>result_label</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;result&#39;</span>
<span class=ln>58</span>    <span class=n>result_label</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=n>view</span><span class=o>.</span><span class=n>width</span>
<span class=ln>59</span>    <span class=n>result_label</span><span class=o>.</span><span class=n>alignment</span> <span class=o>=</span> <span class=n>ui</span><span class=o>.</span><span class=n>ALIGN_CENTER</span>
<span class=ln>60</span>
<span class=ln>61</span>    <span class=n>horizontal_centre</span> <span class=o>=</span> <span class=n>view</span><span class=o>.</span><span class=n>width</span> <span class=o>*</span> <span class=mf>0.5</span>
<span class=ln>62</span>    <span class=n>field_spacing</span> <span class=o>=</span> <span class=n>amount_field</span><span class=o>.</span><span class=n>height</span> <span class=o>*</span> <span class=mf>1.5</span>
<span class=ln>63</span>    <span class=n>amount_field</span><span class=o>.</span><span class=n>center</span> <span class=o>=</span> <span class=p>(</span><span class=n>horizontal_centre</span><span class=p>,</span> <span class=n>amount_field</span><span class=o>.</span><span class=n>height</span><span class=p>)</span>
<span class=ln>64</span>    <span class=n>year_field</span><span class=o>.</span><span class=n>center</span> <span class=o>=</span> <span class=p>(</span><span class=n>horizontal_centre</span><span class=p>,</span>
<span class=ln>65</span>                         <span class=n>amount_field</span><span class=o>.</span><span class=n>center</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>field_spacing</span><span class=p>)</span>
<span class=ln>66</span>    <span class=n>button</span><span class=o>.</span><span class=n>center</span> <span class=o>=</span> <span class=p>(</span><span class=n>horizontal_centre</span><span class=p>,</span>
<span class=ln>67</span>                     <span class=n>year_field</span><span class=o>.</span><span class=n>center</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>field_spacing</span> <span class=o>*</span> <span class=mf>0.75</span><span class=p>)</span>
<span class=ln>68</span>    <span class=n>result_label</span><span class=o>.</span><span class=n>center</span> <span class=o>=</span> <span class=p>(</span><span class=n>horizontal_centre</span><span class=p>,</span>
<span class=ln>69</span>                           <span class=n>button</span><span class=o>.</span><span class=n>centre</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>field_spacing</span> <span class=o>*</span> <span class=mf>0.75</span><span class=p>)</span>
<span class=ln>70</span>
<span class=ln>71</span>    <span class=n>view</span><span class=o>.</span><span class=n>add_subview</span><span class=p>(</span><span class=n>amount_field</span><span class=p>)</span>
<span class=ln>72</span>    <span class=n>view</span><span class=o>.</span><span class=n>add_subview</span><span class=p>(</span><span class=n>year_field</span><span class=p>)</span>
<span class=ln>73</span>    <span class=n>view</span><span class=o>.</span><span class=n>add_subview</span><span class=p>(</span><span class=n>button</span><span class=p>)</span>
<span class=ln>74</span>    <span class=n>view</span><span class=o>.</span><span class=n>add_subview</span><span class=p>(</span><span class=n>result_label</span><span class=p>)</span>
<span class=ln>75</span>
<span class=ln>76</span>    <span class=k>return</span> <span class=n>view</span>
<span class=ln>77</span>
<span class=ln>78</span>
<span class=ln>79</span><span class=n>view</span> <span class=o>=</span> <span class=n>setup_view</span><span class=p>()</span>
<span class=ln>80</span><span class=n>view</span><span class=o>.</span><span class=n>present</span><span class=p>(</span><span class=s1>&#39;sheet&#39;</span><span class=p>)</span>
</code></pre></div><p>And here’s what it looks like in action:</p>
<img src=/images/2015-07-15_historical-dollars.png alt="A screenshot of the historical dollars script run in Pythonista on an iPhone.">
<p>The thing that really tripped me up was <code>.flex</code> on views, for resizing the element based on its containing view. In the code above this isn’t used. I initially followed the example code from the documentation and had all sorts of fun trying to work out why the view spacing was screwed up.</p>
<p>Another problem was expecting the &lsquo;master&rsquo;, containing view (instantiated on line 34) to have the same size as the screen, when it seems to act kind of like HTML elements do when they’re full of floated elements (they collapse). That’s why I set the containing view’s size on line 37. (<code>get_screen_size</code> also seems to always return the portrait size.) All sorts of headaches resulted from this (centring elements based on the view’s centre particularly).</p>
<p>Otherwise, it’s so straightforward and repetitive that I’m not going to explain most of the lines. It works well enough on an iPhone 5-sized screen in portrait mode (elements are off-centre in landscape) but for smaller screens you may want to shift things about a bit vertically.</p>
<p>There are a couple of things to note. The names you give to elements are how you pick them out later (check out lines 11 and 40). Setting the button’s action (line 54) is obviously key, and you just give it a function object. And specifying the keyboard type for the two text fields relieves the need to do input validation (though the decimal keyboard lets you type multiple points), but frankly anyone who might use this should understand that it’ll break if you type in something funky.</p>
<p>I’ve put <a href=https://gist.github.com/robjwells/9bcdb0cac8d234d1ab7e>the whole file online</a> if that’s easier for anyone. You just need to paste it into an empty script in Pythonista and run it.</p>
</article>
</main>
<footer class=site-footer>
<small class=mute-links>
This work is licensed under a
<a rel=license href=https://creativecommons.org/licenses/by/4.0/>
Creative Commons Attribution 4.0 International License</a>.
</small>
</footer>
</div>
</body>
</html>